(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16125,        408]
NotebookOptionsPosition[     15268,        387]
NotebookOutlinePosition[     15660,        403]
CellTagsIndexPosition[     15617,        400]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "u1", ",", " ", "v1", ",", " ", "u2", ",", " ", "v2", ",", " ", "u3", ",", 
   " ", "v3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N1", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", "4"}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{"1", "+", "s"}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{"1", "+", "t"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"N2", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", "4"}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{"1", "-", "s"}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{"1", "+", "t"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"N3", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", "2"}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{"1", "-", "t"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Nmat", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "N1", ",", " ", "0", ",", " ", "N2", ",", " ", "0", ",", " ", "N3", ",", 
      " ", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", " ", "N1", ",", " ", "0", ",", " ", "N2", ",", " ", "0", ",", 
      " ", "N3"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"uv", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "u1", "}"}], ",", 
    RowBox[{"{", "v1", "}"}], ",", 
    RowBox[{"{", "u2", "}"}], ",", 
    RowBox[{"{", "v2", "}"}], ",", 
    RowBox[{"{", "u3", "}"}], ",", 
    RowBox[{"{", "v3", "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"rz", " ", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "r1", "}"}], ",", 
    RowBox[{"{", "z1", "}"}], ",", 
    RowBox[{"{", "r2", "}"}], ",", 
    RowBox[{"{", "z2", "}"}], ",", 
    RowBox[{"{", "r3", "}"}], ",", 
    RowBox[{"{", "z3", "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"uvst", ":=", 
  RowBox[{"Nmat", ".", "uv"}]}], "\[IndentingNewLine]", 
 RowBox[{"rzst", ":=", 
  RowBox[{"Nmat", ".", "rz"}]}]}], "Input",
 CellChangeTimes->{{3.888243173993826*^9, 3.888243210900341*^9}, {
   3.888243241807598*^9, 3.888243352408589*^9}, {3.888243454371196*^9, 
   3.888243495971312*^9}, {3.8882435679107513`*^9, 3.888243588386003*^9}, {
   3.888244497736967*^9, 3.888244500181293*^9}, 3.8882485088914347`*^9, {
   3.888248549865184*^9, 3.8882485692781057`*^9}, {3.8882501545949097`*^9, 
   3.888250162098921*^9}, {3.8882507557107277`*^9, 3.888250867851288*^9}, {
   3.8884918506219673`*^9, 3.888491949004945*^9}, {3.888492179599715*^9, 
   3.888492181693231*^9}, {3.8884922271988697`*^9, 3.888492233051441*^9}, {
   3.888492312385272*^9, 3.888492312559701*^9}, {3.891344613175509*^9, 
   3.891344614518825*^9}, {3.8913450956150217`*^9, 3.891345161762137*^9}, {
   3.891345261550058*^9, 3.891345283384872*^9}, {3.8913455716279593`*^9, 
   3.8913455777879343`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"5ba9383e-ca47-4766-bf14-b89b76ad9be4"],

Cell[BoxData[{
 RowBox[{"Jac", " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"rzst", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "s"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"rzst", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "s"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"rzst", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "t"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"rzst", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "t"}], "]"}]}], 
      "}"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"JacI", " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Inverse", "[", "Jac", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dN1dx", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"JacI", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"D", "[", 
        RowBox[{"N1", ",", "s"}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"D", "[", 
        RowBox[{"N1", ",", "t"}], "]"}], "}"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dN2dx", ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"JacI", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"D", "[", 
        RowBox[{"N2", ",", "s"}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"D", "[", 
        RowBox[{"N2", ",", "t"}], "]"}], "}"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dN3dx", ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"JacI", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"D", "[", 
        RowBox[{"N3", ",", "s"}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"D", "[", 
        RowBox[{"N3", ",", "t"}], "]"}], "}"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"B", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dN1dx", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", "0", ",", " ", 
      RowBox[{"dN2dx", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", "0", ",", " ", 
      RowBox[{"dN3dx", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"dN1dx", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", "0", ",", " ", 
      RowBox[{"dN2dx", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", "0", ",", " ", 
      RowBox[{"dN3dx", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"N1", "/", "r"}], ",", " ", "0", ",", " ", 
      RowBox[{"N2", "/", "r"}], ",", " ", "0", ",", " ", 
      RowBox[{"N3", "/", "r"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dN1dx", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"dN1dx", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"dN2dx", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"dN2dx", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"dN3dx", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"dN3dx", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dmat", ":=", 
  RowBox[{
   RowBox[{"ym", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "v"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "*", "v"}]}], ")"}]}], ")"}]}], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", "v"}], ",", " ", "v", ",", " ", "v", ",", " ", "0"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", " ", 
       RowBox[{"1", "-", "v"}], ",", " ", "v", ",", " ", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", " ", "v", ",", " ", 
       RowBox[{"1", "-", "v"}], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", "*", "v"}]}], ")"}], "/", "2"}]}], "}"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Integrand1", " ", ":=", " ", 
  RowBox[{"B", "*", 
   RowBox[{"Det", "[", "Jac", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Integrand2", " ", ":=", " ", 
  RowBox[{"Dmat", ".", "Integrand1"}]}], "\[IndentingNewLine]", 
 RowBox[{"Integrand3", ":=", 
  RowBox[{
   RowBox[{"Transpose", "[", "B", "]"}], ".", 
   "Integrand2"}]}], "\[IndentingNewLine]", 
 RowBox[{"Integrand4", " ", ":=", " ", 
  RowBox[{"Simplify", "[", "Integrand3", "]"}]}]}], "Input",
 CellChangeTimes->{{3.888243636610813*^9, 3.888243762404656*^9}, {
   3.8882437934979753`*^9, 3.888244001777422*^9}, {3.888244071445071*^9, 
   3.888244188789755*^9}, {3.888244225753992*^9, 3.88824433268582*^9}, {
   3.888244377639312*^9, 3.8882444001930304`*^9}, {3.8882444410300083`*^9, 
   3.888244445282439*^9}, {3.888244481721986*^9, 3.88824452031921*^9}, {
   3.8882445540347977`*^9, 3.888244568999566*^9}, {3.888244614128399*^9, 
   3.888244746392068*^9}, {3.888244797355619*^9, 3.888244990998763*^9}, {
   3.888245041257265*^9, 3.888245158561685*^9}, {3.8882451980971317`*^9, 
   3.8882452010975447`*^9}, {3.888245281494866*^9, 3.888245375913727*^9}, {
   3.888245420510482*^9, 3.8882456083359632`*^9}, {3.8882456396040154`*^9, 
   3.888245695335805*^9}, {3.88824639188245*^9, 3.888246398571354*^9}, {
   3.888246885730897*^9, 3.8882469223161173`*^9}, {3.888247037364706*^9, 
   3.888247089879569*^9}, {3.888247133286439*^9, 3.888247208609538*^9}, 
   3.888247428457965*^9, {3.888247555141643*^9, 3.888247620108698*^9}, {
   3.8882479795512733`*^9, 3.888248137599221*^9}, {3.888248207587949*^9, 
   3.888248275711549*^9}, {3.888248336148293*^9, 3.888248404336459*^9}, {
   3.88824843643717*^9, 3.88824846213031*^9}, {3.888248608612123*^9, 
   3.8882486089047003`*^9}, {3.8882486521449633`*^9, 3.888248730987364*^9}, {
   3.8882488235620193`*^9, 3.8882488388686132`*^9}, {3.8882501067303667`*^9, 
   3.8882501251336*^9}, {3.8882503146906757`*^9, 3.888250347310236*^9}, {
   3.888250381430588*^9, 3.888250547003705*^9}, {3.8882506230811872`*^9, 
   3.888250692833028*^9}, {3.8882508756524067`*^9, 3.8882509745737953`*^9}, {
   3.8882510948449078`*^9, 3.888251095547061*^9}, {3.888251228602067*^9, 
   3.888251229407908*^9}, {3.888251464800428*^9, 3.888251465314398*^9}, {
   3.888251609301126*^9, 3.888251616912221*^9}, {3.8882545965097733`*^9, 
   3.888254672054656*^9}, {3.8882555768882236`*^9, 3.888255626565732*^9}, {
   3.888255665407543*^9, 3.888255698543095*^9}, {3.888255736773877*^9, 
   3.888255737042993*^9}, {3.888255785561791*^9, 3.888255840068956*^9}, {
   3.8882558754217873`*^9, 3.888255875795805*^9}, {3.888267322247085*^9, 
   3.888267322576744*^9}, {3.8884921835350027`*^9, 3.888492189315963*^9}, {
   3.888492305147852*^9, 3.8884923054732018`*^9}, {3.888492340360917*^9, 
   3.8884925750885563`*^9}, {3.891344703798155*^9, 3.8913447043369923`*^9}, {
   3.891344899799789*^9, 3.8913449008543262`*^9}, {3.8913450227159233`*^9, 
   3.891345041770151*^9}, {3.8913453200089073`*^9, 3.8913453312168827`*^9}, {
   3.891345500275033*^9, 3.891345534030682*^9}, {3.891345872772541*^9, 
   3.891345926210526*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"848a1c5a-b1cb-4952-a868-48910d1f7883"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.888251111284809*^9, 3.888251139855205*^9}, {
  3.8882511728747883`*^9, 3.888251373094904*^9}, {3.888251403892148*^9, 
  3.888251482879897*^9}, {3.8882515313329983`*^9, 3.8882515450643682`*^9}, {
  3.891344641786106*^9, 3.891344665590252*^9}, {3.891344912758462*^9, 
  3.891344914546327*^9}, {3.891345081506926*^9, 3.891345082475587*^9}, {
  3.8913451868970337`*^9, 
  3.891345189235374*^9}},ExpressionUUID->"f4a57111-08ce-4c4b-993c-\
bed893c11bf6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"r1", ":=", " ", "0.5"}], "\[IndentingNewLine]", 
 RowBox[{"r2", " ", ":=", " ", "0.75"}], "\[IndentingNewLine]", 
 RowBox[{"r3", ":=", " ", "1"}], "\[IndentingNewLine]", 
 RowBox[{"z1", ":=", " ", "0"}], "\[IndentingNewLine]", 
 RowBox[{"z2", ":=", " ", "0.25"}], "\[IndentingNewLine]", 
 RowBox[{"z3", " ", ":=", " ", "0"}], "\[IndentingNewLine]", 
 RowBox[{"r", " ", ":=", " ", "0.75"}], "\[IndentingNewLine]", 
 RowBox[{"ym", " ", ":=", " ", "1000"}], "\[IndentingNewLine]", 
 RowBox[{"v", ":=", "0.3"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{"Integrand4", ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.891344726970337*^9, 3.8913447477824507`*^9}, {
  3.8913462877139378`*^9, 3.891346333051641*^9}, {3.891346385634289*^9, 
  3.891346387423691*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"a629cba6-77b8-4fad-b4f2-625b5743a645"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "393.5185185185184`"}], 
      RowBox[{"-", "208.33333333333331`"}], "211.89458689458687`", 
      "224.3589743589743`", "227.92022792022786`", 
      RowBox[{"-", "16.025641025641008`"}]},
     {
      RowBox[{"-", "208.33333333333331`"}], 
      RowBox[{"-", "432.6923076923076`"}], "224.3589743589743`", 
      "673.076923076923`", "80.1282051282051`", 
      RowBox[{"-", "240.38461538461536`"}]},
     {"211.89458689458687`", "224.3589743589743`", 
      RowBox[{"-", "409.54415954415947`"}], 
      RowBox[{"-", "64.10256410256409`"}], "147.79202279202278`", 
      RowBox[{"-", "160.25641025641028`"}]},
     {"224.3589743589743`", "673.076923076923`", 
      RowBox[{"-", "64.10256410256409`"}], 
      RowBox[{"-", "1346.153846153846`"}], 
      RowBox[{"-", "352.5641025641025`"}], "673.076923076923`"},
     {"227.92022792022786`", "80.1282051282051`", "147.7920227920228`", 
      RowBox[{"-", "352.5641025641025`"}], 
      RowBox[{"-", "521.7236467236467`"}], "272.43589743589746`"},
     {
      RowBox[{"-", "16.025641025641008`"}], 
      RowBox[{"-", "240.38461538461536`"}], 
      RowBox[{"-", "160.25641025641028`"}], "673.076923076923`", 
      "272.43589743589735`", 
      RowBox[{"-", "432.6923076923076`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.891344778096449*^9, 3.8913449535939493`*^9, 
  3.8913452074560413`*^9, 3.891346228807296*^9, 3.891346346290152*^9, 
  3.8913464010813713`*^9},
 CellLabel->
  "Out[134]//MatrixForm=",ExpressionUUID->"20e54efe-4325-483d-85fc-\
bd62bd54da24"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"B", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.891346788792066*^9, 
  3.891346800613482*^9}},ExpressionUUID->"e2da024f-1fa0-4948-bf7e-\
953c7c820fa5"]
},
WindowSize->{1746, 954},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d4d25346-7e14-46d1-bedb-acae598bcef6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2864, 72, 246, "Input",ExpressionUUID->"5ba9383e-ca47-4766-bf14-b89b76ad9be4"],
Cell[3425, 94, 8039, 198, 324, "Input",ExpressionUUID->"848a1c5a-b1cb-4952-a868-48910d1f7883"],
Cell[11467, 294, 497, 8, 37, "Input",ExpressionUUID->"f4a57111-08ce-4c4b-993c-bed893c11bf6"],
Cell[CellGroupData[{
Cell[11989, 306, 1102, 24, 272, "Input",ExpressionUUID->"a629cba6-77b8-4fad-b4f2-625b5743a645"],
Cell[13094, 332, 1970, 46, 167, "Output",ExpressionUUID->"20e54efe-4325-483d-85fc-bd62bd54da24"]
}, Open  ]],
Cell[15079, 381, 185, 4, 37, "Input",ExpressionUUID->"e2da024f-1fa0-4948-bf7e-953c7c820fa5"]
}
]
*)

